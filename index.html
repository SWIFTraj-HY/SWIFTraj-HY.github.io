<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SWIFTraj - Home</title>
  
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="static/css/index.css">
  
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script defer src="static/js/common.js"></script>

  <style>
    /* Sticky sidebar navigation */
    .sticky-menu {
      position: -webkit-sticky;
      position: sticky;
      top: 2rem;
      max-height: calc(100vh - 4rem);
      overflow-y: auto;
    }
    
    /* Smooth scrolling offset to account for potential fixed headers or padding */
    html {
      scroll-behavior: smooth;
    }
    
    :target {
      scroll-margin-top: 2rem;
    }

    /* Active state for side menu */
    .menu-list a.is-active {
      background-color: var(--primary-color);
      color: #fff;
    }

    /* Sidebar toggle button style */
    .sidebar-toggle {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      z-index: 1000;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--primary-color);
      color: white;
      border: none;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      transition: transform 0.3s ease, background 0.3s ease;
    }

    .sidebar-toggle:hover {
      transform: translateY(-2px);
      background: var(--primary-hover);
    }
    
    /* Custom style for the sidebar column transition */
    .column {
      transition: all 0.3s ease;
    }
    
    /* Style for close button in sidebar */
    .sidebar-close {
        float: right;
        background: none;
        border: none;
        cursor: pointer;
        color: var(--text-light);
        padding: 0.2rem;
    }
    .sidebar-close:hover {
        color: var(--text-primary);
    }
    
    /* Sidebar content transition */
    #sidebar-col aside {
      transition: opacity 0.4s ease, transform 0.4s ease;
      opacity: 1;
      transform: translateY(0);
    }
    
    /* State when sidebar is closed (hidden but keeps space) */
    #sidebar-col.is-closed aside {
      opacity: 0;
      transform: translateY(50px);
      pointer-events: none;
    }

    /* Floating toggle when sidebar is hidden */
    #sidebar-floating-toggle {
        display: none;
        position: fixed;
        right: 2rem;
        bottom: 2rem;
        z-index: 99;
    }
    #sidebar-floating-toggle.visible {
        display: flex;
    }

    /* Adjustments for content inside columns */
    .content-block {
      margin-bottom: 3rem;
      padding: 2rem;
      border-radius: 8px;
    }
    .content-block.is-light {
      background-color: #f5f5f5;
    }

    /* Data Summary Image Alignment */
    .summary-image-container {
      height: 160px;
      width: 100%;
      margin-bottom: 1rem;
      /* Remove flex centering to rely on object-fit and block layout */
    }
    .summary-image-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      /* Ensure no max-width constraints interfere */
      max-width: 100%;
    }

    /* Feature Section Styling (Experiment & Processing) */
    .feature-row {
      margin-bottom: 2rem;
      align-items: center; /* Vertical center alignment */
    }
    
    .feature-image {
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-md);
      transition: var(--transition);
      background-color: white; /* Slight border/bg for image itself */
    }
    
    .feature-image img {
      border-radius: var(--border-radius);
      display: block;
      width: 100%;
      height: auto;
    }
    
    .feature-image:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }
    
    .feature-caption {
      margin-top: 0.75rem;
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-style: italic;
      text-align: center;
    }

    /* Responsive adjustments */
    @media screen and (max-width: 768px) {
      .feature-row {
        gap: 1.5rem;
      }
      .feature-row .columns {
        flex-direction: column-reverse;
      }
    }
  </style>
</head>
<body>

  <!-- Hero: 轨迹图 + 俯拍视频 -->
  <section class="hero hero-banner hero-immersive">
    <div class="hero-bg hero-bg-video">
      <video class="hero-bg-video-el" autoplay muted loop playsinline preload="metadata">
        <source src="static/videos/banner_video_20mm.mp4" type="video/mp4">
      </video>
      <div class="hero-bg-overlay"></div>
    </div>
    <div class="hero-body">
      <div class="container is-widescreen hero-shell">
        <div class="hero-copy">
          <!-- <p class="eyebrow">High-Resolution Trajectory · Aerial View</p> -->
          <h1 class="title is-1 publication-title">Swarm Intelligence Freeway–Urban Trajectories (SWIFTraj) Dataset</h1>
          <!-- <h2 class="subtitle is-3">SWIFTraj</h2> -->
          <p class="lead">SwiftTraj is an open source, drone based vehicle trajectory dataset that provides large scale, continuous, and high resolution trajectories across both freeway and urban networks, enabling comprehensive analysis of traffic phenomena, driver behavior, and intelligent vehicle applications.</p>
        </div>

        <div class="hero-stage">
          <div class="stage-card">
            <div class="stage-media stage-media-image">
              <img src="static/images/F2_lane1_2.gif" alt="Trajectory heatmap">
            </div>
            <!-- <div class="stage-footer">
              <div class="foot-left">
                <span class="dot"></span>
                <span>Trajectory visualization</span>
              </div>
            </div> -->
          </div>
        </div>

      </div>
    </div>
  </section>

  <section class="section">
    <!-- Reduced padding from 5% to 1.5rem for more width -->
    <div class="container is-fluid" style="padding: 0 1.5rem;">
      <div class="columns">

        <!-- Main Content: Takes up all remaining space -->
        <div id="main-content" class="column is-10">
          <!-- Data Summary (1 Row, 4 Columns) -->
          <div id="data-summary" class="content-block">
            <h2 class="title is-3 has-text-centered">Data Summary</h2>

            <div class="columns">
              <!-- Col 1 -->
              <div class="column">
                <h3 class="title is-5 has-text-centered mb-3">16 Drones</h3>
                <figure class="image">
                  <img src="static/images/summary1.png" alt="Summary 1">
                </figure>
                <p class="content is-size-7 has-text-left mt-2">
                  Simultaneously hovering over multiple freeway sections to provide continuous coverage.
                </p>
              </div>

              <!-- Col 2 -->
              <div class="column">
                <h3 class="title is-5 has-text-centered mb-3">Hybrid Network</h3>
                <figure class="image">
                  <img src="static/images/summary2.png" alt="Summary 2">
                </figure>
                <p class="content is-size-7 has-text-left mt-2">
                  A long freeway corridor together with its connected urban road network.
                </p>
              </div>

              <!-- Col 3 -->
              <div class="column">
                <h3 class="title is-5 has-text-centered mb-3">4.5 km Coverage</h3>
                <figure class="image">
                  <img src="static/images/summary3.png" alt="Summary 3">
                </figure>
                <p class="content is-size-7 has-text-left mt-2">
                  Continuous vehicle trajectories along a 4.5 km freeway corridor.
                </p>
              </div>

              <!-- Col 4 -->
              <div class="column">
                <h3 class="title is-5 has-text-centered mb-3">Multiple Bottlenecks</h3>
                <figure class="image">
                  <img src="static/images/summary4.png" alt="Summary 4">
                </figure>
                <p class="content is-size-7 has-text-left mt-2">
                  Consecutive bottlenecks along the corridor, including weaving and merge bottlenecks.
                </p>
              </div>
            </div>
          </div>

          <!-- Experiment Details (1 Column, Markdown) -->
          <div id="experiment-details" class="content-block is-light">
            <h2 class="title is-3 has-text-centered">Experiment Details</h2>
            <div class="columns is-vcentered feature-row">
              <div class="column is-7">
                <!-- Markdown Content -->
                <div id="experiment-content" class="content markdown-body">
                  <p class="has-text-centered">Loading experiment details...</p>
                </div>
              </div>
              <div class="column is-5">
                <!-- Image -->
                <figure class="feature-image">
                  <img src="static/images/experiment1.png" alt="Experiment Setup">
                </figure>
                <figcaption class="feature-caption">Drone deployment locations shown on the satellite map</figcaption>
                <figure class="feature-image">
                  <img src="static/images/experiment2.png" alt="Experiment Setup">
                </figure>
                <figcaption class="feature-caption">Drone deployment locations shown on the topological map</figcaption>
              </div>
            </div>
          </div>

          <!-- Data Processing (Markdown) -->
          <div id="data-processing" class="content-block">
            <h2 class="title is-3 has-text-centered">Data Processing</h2>
            <div class="columns is-vcentered feature-row">
              <div class="column is-7">
                <!-- Markdown Content -->
                <div id="processing-content" class="content markdown-body">
                    <p class="has-text-centered">Loading processing details...</p>
                </div>
              </div>
              <div class="column is-5">
                <figure class="feature-image">
                  <img src="static/images/home/trajectory_extraction.png" alt="Data Processing Pipeline">
                </figure>
                <figcaption class="feature-caption">Overview of the UAV-based vehicle trajectory extraction pipeline</figcaption>
              <figure class="feature-image">
                  <img src="static/images/home/processing2.png" alt="Data Processing Pipeline">
                </figure>
                <figcaption class="feature-caption">Overview of the multi-UAV trajectory stitching pipeline</figcaption>
              </div>
            </div>
          </div>

          <!-- Potential Usage (4 Columns) -->
          <div id="potential-usage" class="content-block is-light">
            <h2 class="title is-3 has-text-centered">Data usage for research possibilities</h2>

            <div class="columns">

              <!-- Usage 1 -->
              <div class="column has-text-centered">
                <figure class="image is-4by3">
                  <img src="static/images/usage1.png" alt="Usage 1">
                </figure>
              </div>

              <!-- Usage 2 -->
              <div class="column has-text-centered">
                <figure class="image is-4by3">
                  <img src="static/images/usage2.png" alt="Usage 2">
                </figure>
              </div>

              <!-- Usage 3 -->
              <div class="column has-text-centered">
                <figure class="image is-4by3">
                  <img src="static/images/usage3.png" alt="Usage 3">
                </figure>
              </div>

              <!-- Usage 4 -->
              <div class="column has-text-centered">
                <figure class="image is-4by3">
                  <img src="static/images/usage4.png" alt="Usage 4">
                </figure>
              </div>

            </div>
          </div>


          <!-- Visitor Statistics -->
          <div class="has-text-centered py-4">
            <div class="is-size-7 has-text-grey">
              <span id="busuanzi_container_site_pv" style="display:none">
                <i class="fas fa-eye"></i> Total Visits: <span id="busuanzi_value_site_pv"></span>
              </span>
              <span class="mx-3" style="margin: 0 10px;">|</span>
              <span id="busuanzi_container_site_uv" style="display:none">
                <i class="fas fa-user"></i> Visitors: <span id="busuanzi_value_site_uv"></span>
              </span>
            </div>
          </div>
          <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        
        </div>

        <!-- Sidebar Navigation Column -->
        <!-- Matches Left Spacer width -->
        <div id="sidebar-col" class="column is-2 is-hidden-mobile">
          <aside class="menu sticky-menu pl-2">
            <div class="is-flex is-justify-content-space-between is-align-items-center mb-2">
                <p class="menu-label mb-0">Contents</p>
                <button id="btn-close-sidebar" class="sidebar-close" title="Hide Sidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <ul class="menu-list">
              <li><a href="#data-summary">Data Summary</a></li>
              <li><a href="#experiment-details">Experiment Details</a></li>
              <li><a href="#data-processing">Data Processing</a></li>
              <li><a href="#potential-usage">Potential Usage</a></li>
            </ul>
            
            <p class="menu-label mt-5">
              Links
            </p>
            <ul class="menu-list">
              <li><a href="data-description.html">Data Description</a></li>
              <li><a href="download.html">Download Data</a></li>
            </ul>
          </aside>
        </div>

      </div>
    </div>
  </section>

  <!-- Floating Toggle Button (Hidden by default) -->
  <button id="sidebar-floating-toggle" class="sidebar-toggle" title="Show Sidebar">
    <i class="fas fa-list-ul"></i>
  </button>

  <!-- Image Modal -->
  <div class="modal" id="image-modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <p class="image">
        <img src="" alt="">
      </p>
    </div>
    <button class="modal-close is-large" aria-label="close"></button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        loadMarkdown('experiment-content', 'static/md/home_experiment.md');
        loadMarkdown('processing-content', 'static/md/home_processing.md');

        // --- Sidebar Toggle Logic ---
        const sidebarCol = document.getElementById('sidebar-col');
        // const leftSpacer = document.getElementById('left-spacer'); // spacer 始终保留，不操作
        const mainContent = document.getElementById('main-content');
        const closeBtn = document.getElementById('btn-close-sidebar');
        const floatToggleBtn = document.getElementById('sidebar-floating-toggle');

        function hideSidebar() {
          // 只隐藏内容，保留占位，确保中间内容宽度不跳变
          // 使用 CSS class 控制动画
          sidebarCol.classList.add('is-closed');
          
          // 显示悬浮按钮
          floatToggleBtn.classList.add('visible');
        }

        function showSidebar() {
          // 恢复显示
          sidebarCol.classList.remove('is-closed');
          
          // 隐藏悬浮按钮
          floatToggleBtn.classList.remove('visible');
        }

        closeBtn.addEventListener('click', hideSidebar);
        floatToggleBtn.addEventListener('click', showSidebar);

        // --- Image Modal Logic ---
        const modal = document.getElementById('image-modal');
        const modalImg = modal.querySelector('.modal-content img');
        const modalBackground = modal.querySelector('.modal-background');
        const modalClose = modal.querySelector('.modal-close');
        
        // Select images in Data Summary section
        const summaryImages = document.querySelectorAll('#data-summary .image img');
        
        summaryImages.forEach(img => {
          img.style.cursor = 'pointer'; // Make it look clickable
          img.addEventListener('click', () => {
            modalImg.src = img.src;
            modalImg.alt = img.alt;
            modal.classList.add('is-active');
          });
        });

        function closeModal() {
          modal.classList.remove('is-active');
          modalImg.src = ''; // Clear source to stop potential loading/memory
        }

        if (modalClose) modalClose.addEventListener('click', closeModal);
        if (modalBackground) modalBackground.addEventListener('click', closeModal);
        
        // Close on Escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && modal.classList.contains('is-active')) {
            closeModal();
          }
        });

      // --- Scroll Spy Logic ---
      const sections = ['data-summary', 'experiment-details', 'data-processing', 'potential-usage'];
      const navLinks = document.querySelectorAll('.menu-list a[href^="#"]');

      function updateActiveLink() {
        let current = '';
        
        // 这种方式能处理 section 高度不一的情况
        // 这里的逻辑是：找出所有“顶部在视口观测线之上”的 section 中，最靠下的那个
        // 观测线设为视口顶端向下 100px (或者 header 高度)
        sections.forEach(sectionId => {
          const section = document.getElementById(sectionId);
          if (section) {
            const rect = section.getBoundingClientRect();
            // 如果 section 的顶部到了视口上方，或者在视口上边缘附近 (比如 150px 以内)
            // 就认为进入了该 section 区域
            if (rect.top <= 150) {
              current = sectionId;
            }
          }
        });

        navLinks.forEach(link => {
          link.classList.remove('is-active');
          if (link.getAttribute('href') === '#' + current) {
            link.classList.add('is-active');
          }
        });
      }

      window.addEventListener('scroll', updateActiveLink);
      // 初始化时也执行一次，防止刷新页面后状态不对
      updateActiveLink();
    });
  </script>

</body>
</html>
